<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Widget Settings</title>
  <script type="module" src="/src/settings.ts" defer></script>
  <style>
    @font-face {
      font-family: 'Lexend';
      src: url('/fonts/Bricolage_Grotesque,DM_Sans,Lexend,Playfair_Display/Lexend/Lexend-VariableFont_wght.ttf') format('truetype');
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }

    :root {
      --bg: #ddd;
      --text: #111;
      --border: #bbb;
      --row-bg: transparent;
      --control-bg: #fff;
      --control-h: 36px;
      --radius: 4px;
      --accent: #2b6cff;
      --seg-active: rgba(0, 0, 0, 0.08);
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #1f1f1f;
        --text: #f2f2f2;
        --border: #444;
        --row-bg: transparent;
        --control-bg: #2a2a2a;
        --seg-active: rgba(255, 255, 255, 0.18);
      }
    }

    [data-theme="light"] {
      --bg: #ddd;
      --text: #111;
      --border: #bbb;
      --row-bg: transparent;
      --control-bg: #fff;
    }

    [data-theme="dark"] {
      --bg: #1f1f1f;
      --text: #f2f2f2;
      --border: #444;
      --row-bg: transparent;
      --control-bg: #2a2a2a;
      --seg-active: rgba(255, 255, 255, 0.18);
    }

    body {
      font-family: "Helvetica Neue", Helvetica, Arial, "Segoe UI", Roboto, "Noto Sans", sans-serif, system-ui;
      background-color: var(--bg);
      color: var(--text);
      margin: 0;
    }

    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 16px;
      box-sizing: border-box;
    }

    /* Column-based layout */
    .columns {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      column-gap: 40px;
      /* uniform gutters between columns */
      align-items: start;
      border-top: 1px solid var(--border);
      /* single solid divider above */
    }

    /* Each column panel */
    .columns>.setsec {
      position: relative;
      border-top: none;
    }

    /* Center vertical divider in the gutter using a pseudo-element */
    .columns>.setsec:not(:last-child)::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      right: -20px;
      /* half of column-gap */
      width: 1px;
      background: var(--border);
    }

    .row {
      display: block;
      margin-bottom: 25px;
    }

    .setsec .row:not(:first-child) {
      margin-top: 16px;
    }

    /* ensures spacing above e.g., Weight */
    .field {
      display: grid;
      grid-template-rows: auto auto;
      row-gap: 6px;
    }

    .w1,
    .w2,
    .span3 {
      grid-column: auto;
    }

    h2 {
      font-size: 2em;
      margin-top: 0;
    }

    label {
      color: var(--text);
      font-size: 13px;
      opacity: .9;
      display: block;
      margin: 0 0 4px 0;
    }

    input[type="text"],
    input[type="number"],
    select,
    textarea {
      padding: 6px 8px;
      width: 100%;
      color: var(--text);
      background-color: var(--control-bg);
      border: 1px solid var(--border);
      display: block;
      box-sizing: border-box;
      min-width: 0;
      height: var(--control-h);
      border-radius: var(--radius);
    }

    .setsec {
      width: 100%;
      border-top: 1px solid var(--border);
      margin-top: 2px;
    }

    /* Improve dropdown option readability in dark mode */
    select,
    option,
    optgroup {
      background-color: var(--control-bg);
      color: var(--text);
    }

    select:focus {
      outline: none;
      border-color: var(--text);
    }

    /* Color input should visually be just the color swatch, same size as other fields */
    input[type="color"] {
      width: 100%;
      height: var(--control-h);
      padding: 0;
      border: 1px solid var(--border);
      background: none;
      box-sizing: border-box;
      appearance: none;
      -webkit-appearance: none;
      border-radius: var(--radius);
    }

    input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 0;
      border-radius: var(--radius);
    }

    input[type="color"]::-webkit-color-swatch {
      border: none;
      border-radius: var(--radius);
    }

    /* Segmented control styles for theme selector */
    .segmented {
      display: inline-grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      background: var(--row-bg);
    }

    .segmented .seg {
      height: var(--control-h);
      padding: 4px 12px;
      background: transparent;
      border: 0;
      color: var(--text);
      cursor: pointer;
    }

    .segmented .seg+.seg {
      border-left: 1px solid var(--border);
    }

    .segmented .seg.active { background: var(--seg-active); }

    input.num {
      width: 100%;
    }

    .spacer {
      margin-left: 0;
    }

    .fill {
      grid-column: 1 / -1;
      width: 100%;
    }

    .preview {
      margin-top: 16px;
      padding: 16px;
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .actions { margin-top: 24px; display: flex; gap: 8px; }
    .actions button { height: var(--control-h); padding: 4px 12px; border-radius: 6px; border: 1px solid var(--border); background: var(--row-bg); color: var(--text); cursor: pointer; }
    #close { background: var(--accent); color: #fff; border-color: var(--accent); }
    #close:hover { filter: brightness(0.96); }

    /* Theme field placed in grid below the title; no absolute positioning */
    /* Quote field larger and pleasant to type in */
    #text { min-height: 140px; font-size: 18px; line-height: 1.5; font-family: inherit; }

    @media (max-width: 880px) {
      .row {
        grid-template-columns: 1fr;
      }

      .columns {
        grid-template-columns: 1fr;
        column-gap: 0;
      }

      .columns>.setsec {
        padding: 0;
      }

      .columns>.setsec::after {
        display: none;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h3>Your Quote</h3>
    <div class="row">
      <textarea id="text" class="fill" rows="3" placeholder="your text goes here"></textarea>
    </div>
    <div class="columns">
      <div class="setsec">
        <h3>Font Settings</h3>
        <div class="row">
          <div class="field">
            <label for="fontFamily">Font family</label>
            <select id="fontFamily" class="w2">
              <option value="system-ui">System UI</option>
              <option value="Lexend, sans-serif">Lexend</option>
              <option value="Playfair Display, serif">Playfair Display</option>
              <option value="DM Sans, sans-serif">DM Sans</option>
              <option value="Bricolage Grotesque, sans-serif">Bricolage Grotesque</option>
              <option value="Instrument Serif, serif">Instrument Serif</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="fontWeight">Weight</label>
            <select id="fontWeight" class="w2">
              <option value="300">Light</option>
              <option value="400">Regular</option>
              <option value="600">SemiBold</option>
              <option value="700">Bold</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="fontSize">Font size (px)</label>
            <input id="fontSize" class="num w2" type="number" min="8" max="300" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="letterSpacing">Letter spacing (px)</label>
            <input id="letterSpacing" class="num w2" type="number" min="-25" max="100" step="0.5" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="color">Color</label>
            <input id="color" class="w2" type="color" />
          </div>
        </div>
      </div>
      <div class="setsec">
        <h3>Drop Shadow</h3>
        <div class="row">
          <div class="field">
            <label for="shadowColor">Color</label>
            <input id="shadowColor" class="w2" type="color" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="shadowBlur">Blur</label>
            <input id="shadowBlur" class="num w2" type="number" min="0" max="200" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="shadowOpacity">Opacity</label>
            <input id="shadowOpacity" class="num w2" type="number" min="0" max="1" step="0.01" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="shadowOffsetX">Offset X (px)</label>
            <input id="shadowOffsetX" class="num w2" type="number" min="-200" max="200" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="shadowOffsetY">Offset Y (px)</label>
            <input id="shadowOffsetY" class="num w2" type="number" min="-200" max="200" />
          </div>
        </div>
      </div>
      <div class="setsec">
        <h3>Layout</h3>
        <div class="row">
          <div class="field">
            <label for="textAlign">Horizontal align</label>
            <select id="textAlign" class="w2">
              <option value="left">Left</option>
              <option value="center">Center</option>
              <option value="right">Right</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="verticalAlign">Vertical align</label>
            <select id="verticalAlign" class="w2">
              <option value="flex-start">Top</option>
              <option value="center">Center</option>
              <option value="flex-end">Bottom</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="padding">Padding (px)</label>
            <input id="padding" class="num w2" type="number" min="0" max="200" />
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label for="display">Display</label>
            <select id="display" class="w2">
              <option value="primary">Primary</option>
              <option value="secondary">Secondary</option>
            </select>
          </div>
        </div>
      </div>
      <div class="setsec">
        <h3>System Settings</h3>
        <div class="row">
          <div class="field check">
            <label><input id="autostart" type="checkbox" /> Start with Windows</label>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>Settings Theme</label>
            <div class="segmented theme-seg" role="tablist" aria-label="Theme">
              <button type="button" class="seg" data-value="system">Auto</button>
              <button type="button" class="seg" data-value="light">Light</button>
              <button type="button" class="seg" data-value="dark">Dark</button>
            </div>
            <select id="themeMode" style="display:none">
              <option value="system">System</option>
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>
        </div>
      </div>
    </div>
          <div class="columns">
      <div class="setsec">
      <div class="actions">
        <button id="close">Save and Close</button>
        <button id="reset">Reset</button>
        </div>
      </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var select = document.getElementById('themeMode');
      var group = document.querySelector('.theme-seg');
      if (!select || !group) return;
      var btns = group.querySelectorAll('button.seg');
      function sync(val) {
        btns.forEach(function (b) { b.classList.toggle('active', b.getAttribute('data-value') === val); });
      }
      sync(select.value || 'system');
      btns.forEach(function (btn) {
        btn.addEventListener('click', function () {
          var v = btn.getAttribute('data-value');
          if (!v) return;
          select.value = v;
          select.dispatchEvent(new Event('change', { bubbles: true }));
          sync(v);
        });
      });
      select.addEventListener('change', function () { sync(select.value); });
      // ensure final state reflects any async store-loaded value
      setTimeout(function(){ sync(select.value || 'system'); }, 50);
    });
  </script>
</body>

</html>
